"use strict";(self.webpackChunkdigitalisation_emargement_frontend=self.webpackChunkdigitalisation_emargement_frontend||[]).push([[518],{6518:(T,_,d)=>{d.r(_),d.d(_,{DashBoardCfaComponent:()=>R});var t=d(8457),c=d(7028),l=d(7136),m=d(177),s=d(4341),u=d(1626);const p=(i,a,o)=>({"text-warning":i,"text-success":a,"text-danger":o});function f(i,a){if(1&i){const o=t.RV6();t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.k0s(),t.j41(5,"td"),t.EFF(6),t.k0s(),t.j41(7,"td"),t.EFF(8),t.k0s(),t.j41(9,"td")(10,"button",22),t.bIt("click",function(){const e=t.eBV(o).$implicit,n=t.XpG(2);return t.Njj(n.remplirForm(e))}),t.EFF(11,"\u270f\ufe0f Modifier"),t.k0s(),t.j41(12,"button",23),t.bIt("click",function(){const e=t.eBV(o).$implicit,n=t.XpG(2);return t.Njj(n.supprimerPromotion(e.id_promotion))}),t.EFF(13,"\u{1f5d1}\ufe0f Supprimer"),t.k0s()()()}if(2&i){const o=a.$implicit;t.R7$(2),t.JRh(o.id_promotion),t.R7$(2),t.JRh(o.nom),t.R7$(2),t.JRh(o.debut_annee_scolaire),t.R7$(2),t.JRh(o.fin_annee_scolaire)}}function g(i,a){if(1&i){const o=t.RV6();t.j41(0,"div",8)(1,"h4",9),t.EFF(2,"\u{1f4c4} Liste des Promotions"),t.k0s(),t.j41(3,"div",10)(4,"table",11)(5,"thead")(6,"tr")(7,"th"),t.EFF(8,"ID"),t.k0s(),t.j41(9,"th"),t.EFF(10,"Nom"),t.k0s(),t.j41(11,"th"),t.EFF(12,"Ann\xe9e d\xe9but"),t.k0s(),t.j41(13,"th"),t.EFF(14,"Ann\xe9e fin"),t.k0s(),t.j41(15,"th"),t.EFF(16,"Actions"),t.k0s()()(),t.j41(17,"tbody"),t.DNE(18,f,14,4,"tr",12),t.k0s()()(),t.j41(19,"form",13,0),t.bIt("ngSubmit",function(){t.eBV(o);const e=t.XpG();return t.Njj(e.soumettreForm())}),t.j41(21,"h5"),t.EFF(22),t.k0s(),t.j41(23,"input",14),t.mxI("ngModelChange",function(e){t.eBV(o);const n=t.XpG();return t.DH7(n.formPromo.id_promotion,e)||(n.formPromo.id_promotion=e),t.Njj(e)}),t.k0s(),t.j41(24,"div",15)(25,"div",16)(26,"label",17),t.EFF(27,"Nom"),t.k0s(),t.j41(28,"input",18),t.mxI("ngModelChange",function(e){t.eBV(o);const n=t.XpG();return t.DH7(n.formPromo.nom,e)||(n.formPromo.nom=e),t.Njj(e)}),t.k0s()(),t.j41(29,"div",16)(30,"label",17),t.EFF(31,"Ann\xe9e d\xe9but"),t.k0s(),t.j41(32,"input",19),t.mxI("ngModelChange",function(e){t.eBV(o);const n=t.XpG();return t.DH7(n.formPromo.debut_annee_scolaire,e)||(n.formPromo.debut_annee_scolaire=e),t.Njj(e)}),t.k0s()(),t.j41(33,"div",16)(34,"label",17),t.EFF(35,"Ann\xe9e fin"),t.k0s(),t.j41(36,"input",20),t.mxI("ngModelChange",function(e){t.eBV(o);const n=t.XpG();return t.DH7(n.formPromo.fin_annee_scolaire,e)||(n.formPromo.fin_annee_scolaire=e),t.Njj(e)}),t.k0s()()(),t.j41(37,"button",21),t.EFF(38,"\u{1f4c4} Enregistrer"),t.k0s()()()}if(2&i){const o=t.XpG();t.R7$(18),t.Y8G("ngForOf",o.promotions),t.R7$(4),t.SpI("",o.promoEnEdition?"\u270f\ufe0f Modifier":"\u2795 Ajouter"," une Promotion"),t.R7$(),t.R50("ngModel",o.formPromo.id_promotion),t.R7$(5),t.R50("ngModel",o.formPromo.nom),t.R7$(4),t.R50("ngModel",o.formPromo.debut_annee_scolaire),t.R7$(4),t.R50("ngModel",o.formPromo.fin_annee_scolaire)}}function h(i,a){if(1&i){const o=t.RV6();t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.k0s(),t.j41(5,"td"),t.EFF(6),t.k0s(),t.j41(7,"td")(8,"button",22),t.bIt("click",function(){const e=t.eBV(o).$implicit,n=t.XpG(2);return t.Njj(n.remplirFormGroupe(e))}),t.EFF(9,"\u270f\ufe0f Modifier"),t.k0s(),t.j41(10,"button",23),t.bIt("click",function(){const e=t.eBV(o).$implicit,n=t.XpG(2);return t.Njj(n.supprimerGroupe(e.id_groupe))}),t.EFF(11,"\u{1f5d1}\ufe0f Supprimer"),t.k0s()()()}if(2&i){const o=a.$implicit,r=t.XpG(2);t.R7$(2),t.JRh(o.id_groupe),t.R7$(2),t.JRh(o.nom),t.R7$(2),t.JRh(r.getNomPromotion(o.id_promotion))}}function E(i,a){if(1&i&&(t.j41(0,"option",27),t.EFF(1),t.k0s()),2&i){const o=a.$implicit;t.Y8G("value",o.id_promotion),t.R7$(),t.SpI(" ",o.nom," ")}}function F(i,a){if(1&i){const o=t.RV6();t.j41(0,"div",8)(1,"h4",9),t.EFF(2,"\u{1f465} Liste des Groupes"),t.k0s(),t.j41(3,"div",10)(4,"table",11)(5,"thead")(6,"tr")(7,"th"),t.EFF(8,"ID"),t.k0s(),t.j41(9,"th"),t.EFF(10,"Nom"),t.k0s(),t.j41(11,"th"),t.EFF(12,"Promotion"),t.k0s(),t.j41(13,"th"),t.EFF(14,"Actions"),t.k0s()()(),t.j41(15,"tbody"),t.DNE(16,h,12,3,"tr",12),t.k0s()()(),t.j41(17,"form",13,1),t.bIt("ngSubmit",function(){t.eBV(o);const e=t.XpG();return t.Njj(e.soumettreFormGroupe())}),t.j41(19,"h5"),t.EFF(20),t.k0s(),t.j41(21,"input",14),t.mxI("ngModelChange",function(e){t.eBV(o);const n=t.XpG();return t.DH7(n.formGroupe.id_groupe,e)||(n.formGroupe.id_groupe=e),t.Njj(e)}),t.k0s(),t.j41(22,"div",15)(23,"div",24)(24,"label",17),t.EFF(25,"Nom"),t.k0s(),t.j41(26,"input",18),t.mxI("ngModelChange",function(e){t.eBV(o);const n=t.XpG();return t.DH7(n.formGroupe.nom,e)||(n.formGroupe.nom=e),t.Njj(e)}),t.k0s()(),t.j41(27,"div",24)(28,"label",17),t.EFF(29,"Promotion li\xe9e"),t.k0s(),t.j41(30,"select",25),t.mxI("ngModelChange",function(e){t.eBV(o);const n=t.XpG();return t.DH7(n.formGroupe.id_promotion,e)||(n.formGroupe.id_promotion=e),t.Njj(e)}),t.DNE(31,E,2,2,"option",26),t.k0s()()(),t.j41(32,"button",21),t.EFF(33,"\u{1f4be} Enregistrer"),t.k0s()()()}if(2&i){const o=t.XpG();t.R7$(16),t.Y8G("ngForOf",o.groupes),t.R7$(4),t.SpI("",o.groupeEnEdition?"\u270f\ufe0f Modifier":"\u2795 Ajouter"," un Groupe"),t.R7$(),t.R50("ngModel",o.formGroupe.id_groupe),t.R7$(5),t.R50("ngModel",o.formGroupe.nom),t.R7$(4),t.R50("ngModel",o.formGroupe.id_promotion),t.R7$(),t.Y8G("ngForOf",o.promotions)}}function C(i,a){if(1&i){const o=t.RV6();t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.k0s(),t.j41(5,"td"),t.EFF(6),t.k0s(),t.j41(7,"td"),t.EFF(8),t.k0s(),t.j41(9,"td"),t.EFF(10),t.k0s(),t.j41(11,"td"),t.EFF(12),t.k0s(),t.j41(13,"td")(14,"button",22),t.bIt("click",function(){const e=t.eBV(o).$implicit,n=t.XpG(2);return t.Njj(n.remplirFormEtudiant(e))}),t.EFF(15,"\u270f\ufe0f"),t.k0s(),t.j41(16,"button",23),t.bIt("click",function(){const e=t.eBV(o).$implicit,n=t.XpG(2);return t.Njj(n.supprimerEtudiant(e.NEtudiant))}),t.EFF(17,"\u{1f5d1}\ufe0f"),t.k0s()()()}if(2&i){const o=a.$implicit;t.R7$(2),t.JRh(o.NEtudiant),t.R7$(2),t.JRh(o.nom),t.R7$(2),t.JRh(o.prenom),t.R7$(2),t.JRh(o.email),t.R7$(2),t.JRh(o.id_groupe_TD),t.R7$(2),t.JRh(o.id_groupe_Anglais)}}function j(i,a){if(1&i){const o=t.RV6();t.j41(0,"div",8)(1,"h4",9),t.EFF(2,"\u{1f9d1}\u200d\u{1f393} Liste des \xc9tudiants"),t.k0s(),t.j41(3,"div",10)(4,"table",11)(5,"thead")(6,"tr")(7,"th"),t.EFF(8,"NEtudiant"),t.k0s(),t.j41(9,"th"),t.EFF(10,"Nom"),t.k0s(),t.j41(11,"th"),t.EFF(12,"Pr\xe9nom"),t.k0s(),t.j41(13,"th"),t.EFF(14,"Email"),t.k0s(),t.j41(15,"th"),t.EFF(16,"TD"),t.k0s(),t.j41(17,"th"),t.EFF(18,"Anglais"),t.k0s(),t.j41(19,"th"),t.EFF(20,"Actions"),t.k0s()()(),t.j41(21,"tbody"),t.DNE(22,C,18,6,"tr",12),t.k0s()()(),t.j41(23,"form",13,2),t.bIt("ngSubmit",function(){t.eBV(o);const e=t.XpG();return t.Njj(e.soumettreFormEtudiant())}),t.j41(25,"h5"),t.EFF(26),t.k0s(),t.j41(27,"div",15)(28,"div",16)(29,"label",17),t.EFF(30,"NEtudiant"),t.k0s(),t.j41(31,"input",28),t.mxI("ngModelChange",function(e){t.eBV(o);const n=t.XpG();return t.DH7(n.formEtudiant.NEtudiant,e)||(n.formEtudiant.NEtudiant=e),t.Njj(e)}),t.k0s()(),t.j41(32,"div",16)(33,"label",17),t.EFF(34,"Nom"),t.k0s(),t.j41(35,"input",18),t.mxI("ngModelChange",function(e){t.eBV(o);const n=t.XpG();return t.DH7(n.formEtudiant.nom,e)||(n.formEtudiant.nom=e),t.Njj(e)}),t.k0s()(),t.j41(36,"div",16)(37,"label",17),t.EFF(38,"Pr\xe9nom"),t.k0s(),t.j41(39,"input",29),t.mxI("ngModelChange",function(e){t.eBV(o);const n=t.XpG();return t.DH7(n.formEtudiant.prenom,e)||(n.formEtudiant.prenom=e),t.Njj(e)}),t.k0s()(),t.j41(40,"div",24)(41,"label",17),t.EFF(42,"Email"),t.k0s(),t.j41(43,"input",30),t.mxI("ngModelChange",function(e){t.eBV(o);const n=t.XpG();return t.DH7(n.formEtudiant.email,e)||(n.formEtudiant.email=e),t.Njj(e)}),t.k0s()(),t.j41(44,"div",24)(45,"label",17),t.EFF(46,"Mot de passe"),t.k0s(),t.j41(47,"input",31),t.mxI("ngModelChange",function(e){t.eBV(o);const n=t.XpG();return t.DH7(n.formEtudiant.mot_de_passe,e)||(n.formEtudiant.mot_de_passe=e),t.Njj(e)}),t.k0s()(),t.j41(48,"div",24)(49,"label",17),t.EFF(50,"Groupe TD"),t.k0s(),t.j41(51,"input",32),t.mxI("ngModelChange",function(e){t.eBV(o);const n=t.XpG();return t.DH7(n.formEtudiant.id_groupe_TD,e)||(n.formEtudiant.id_groupe_TD=e),t.Njj(e)}),t.k0s()(),t.j41(52,"div",24)(53,"label",17),t.EFF(54,"Groupe Anglais"),t.k0s(),t.j41(55,"input",33),t.mxI("ngModelChange",function(e){t.eBV(o);const n=t.XpG();return t.DH7(n.formEtudiant.id_groupe_Anglais,e)||(n.formEtudiant.id_groupe_Anglais=e),t.Njj(e)}),t.k0s()()(),t.j41(56,"button",21),t.EFF(57,"\u{1f4be} Enregistrer"),t.k0s()()()}if(2&i){const o=t.XpG();t.R7$(22),t.Y8G("ngForOf",o.etudiants),t.R7$(4),t.SpI("",o.etudiantEnEdition?"\u270f\ufe0f Modifier":"\u2795 Ajouter"," un \xc9tudiant"),t.R7$(5),t.R50("ngModel",o.formEtudiant.NEtudiant),t.Y8G("readonly",o.etudiantEnEdition),t.R7$(4),t.R50("ngModel",o.formEtudiant.nom),t.R7$(4),t.R50("ngModel",o.formEtudiant.prenom),t.R7$(4),t.R50("ngModel",o.formEtudiant.email),t.R7$(4),t.R50("ngModel",o.formEtudiant.mot_de_passe),t.R7$(4),t.R50("ngModel",o.formEtudiant.id_groupe_TD),t.R7$(4),t.R50("ngModel",o.formEtudiant.id_groupe_Anglais)}}function b(i,a){if(1&i&&(t.j41(0,"option",27),t.EFF(1),t.k0s()),2&i){const o=a.$implicit;t.Y8G("value",o.id_promotion),t.R7$(),t.JRh(o.nom)}}function k(i,a){if(1&i&&(t.j41(0,"option",27),t.EFF(1),t.k0s()),2&i){const o=a.$implicit;t.Y8G("value",o.NEtudiant),t.R7$(),t.Lme(" ",o.prenom," ",o.nom," ")}}function D(i,a){if(1&i){const o=t.RV6();t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.k0s(),t.j41(5,"td"),t.EFF(6),t.nI1(7,"date"),t.k0s(),t.j41(8,"td")(9,"a",48),t.EFF(10,"\u{1f4c4} Voir"),t.k0s()(),t.j41(11,"td")(12,"input",49),t.mxI("ngModelChange",function(e){const n=t.eBV(o).$implicit;return t.DH7(n.commentaire_admin,e)||(n.commentaire_admin=e),t.Njj(e)}),t.k0s()(),t.j41(13,"td")(14,"span",50),t.EFF(15),t.k0s()(),t.j41(16,"td")(17,"button",51),t.bIt("click",function(){const e=t.eBV(o).$implicit,n=t.XpG(2);return t.Njj(n.traiterJustificatif(e,"accepte"))}),t.EFF(18,"\u2705"),t.k0s(),t.j41(19,"button",52),t.bIt("click",function(){const e=t.eBV(o).$implicit,n=t.XpG(2);return t.Njj(n.traiterJustificatif(e,"refuse"))}),t.EFF(20,"\u274c"),t.k0s()()()}if(2&i){const o=a.$implicit;t.R7$(2),t.Lme("",o.prenom_etudiant," ",o.nom_etudiant,""),t.R7$(2),t.JRh(o.nom_cours),t.R7$(2),t.JRh(t.i5U(7,8,o.date_heure_debut,"short")),t.R7$(3),t.Y8G("href","http://localhost:3000/uploads/justificatifs/"+o.fichier_url,t.B4B),t.R7$(3),t.R50("ngModel",o.commentaire_admin),t.R7$(2),t.Y8G("ngClass",t.sMw(11,p,"en_attente"===o.statut,"accepte"===o.statut,"refuse"===o.statut)),t.R7$(),t.JRh(o.statut)}}function M(i,a){if(1&i){const o=t.RV6();t.j41(0,"div",8)(1,"h4",9),t.EFF(2,"\u{1f4ce} Justificatifs soumis"),t.k0s(),t.j41(3,"form",34),t.bIt("ngSubmit",function(){t.eBV(o);const e=t.XpG();return t.Njj(e.chargerJustificatifsDepuisFiltres())}),t.j41(4,"div",35)(5,"label",17),t.EFF(6,"Promotion"),t.k0s(),t.j41(7,"select",36),t.mxI("ngModelChange",function(e){t.eBV(o);const n=t.XpG();return t.DH7(n.filtreJustif.id_promotion,e)||(n.filtreJustif.id_promotion=e),t.Njj(e)}),t.j41(8,"option",37),t.EFF(9,"Toutes"),t.k0s(),t.DNE(10,b,2,2,"option",26),t.k0s()(),t.j41(11,"div",35)(12,"label",17),t.EFF(13,"\xc9tudiant"),t.k0s(),t.j41(14,"select",38),t.mxI("ngModelChange",function(e){t.eBV(o);const n=t.XpG();return t.DH7(n.filtreJustif.id_etudiant,e)||(n.filtreJustif.id_etudiant=e),t.Njj(e)}),t.j41(15,"option",37),t.EFF(16,"Tous"),t.k0s(),t.DNE(17,k,2,3,"option",26),t.k0s()(),t.j41(18,"div",39)(19,"label",17),t.EFF(20,"Statut"),t.k0s(),t.j41(21,"select",40),t.mxI("ngModelChange",function(e){t.eBV(o);const n=t.XpG();return t.DH7(n.filtreJustif.statut,e)||(n.filtreJustif.statut=e),t.Njj(e)}),t.j41(22,"option",37),t.EFF(23,"Tous"),t.k0s(),t.j41(24,"option",41),t.EFF(25,"En attente"),t.k0s(),t.j41(26,"option",42),t.EFF(27,"Accept\xe9"),t.k0s(),t.j41(28,"option",43),t.EFF(29,"Refus\xe9"),t.k0s()()(),t.j41(30,"div",39)(31,"label",17),t.EFF(32,"Date min"),t.k0s(),t.j41(33,"input",44),t.mxI("ngModelChange",function(e){t.eBV(o);const n=t.XpG();return t.DH7(n.filtreJustif.date_min,e)||(n.filtreJustif.date_min=e),t.Njj(e)}),t.k0s()(),t.j41(34,"div",39)(35,"label",17),t.EFF(36,"Date max"),t.k0s(),t.j41(37,"input",45),t.mxI("ngModelChange",function(e){t.eBV(o);const n=t.XpG();return t.DH7(n.filtreJustif.date_max,e)||(n.filtreJustif.date_max=e),t.Njj(e)}),t.k0s()(),t.j41(38,"div",46)(39,"button",47),t.EFF(40,"\u{1f50d} Rechercher"),t.k0s()()(),t.j41(41,"div",10)(42,"table",11)(43,"thead")(44,"tr")(45,"th"),t.EFF(46,"\xc9tudiant"),t.k0s(),t.j41(47,"th"),t.EFF(48,"Cours"),t.k0s(),t.j41(49,"th"),t.EFF(50,"Date"),t.k0s(),t.j41(51,"th"),t.EFF(52,"Fichier"),t.k0s(),t.j41(53,"th"),t.EFF(54,"Commentaire"),t.k0s(),t.j41(55,"th"),t.EFF(56,"Statut"),t.k0s(),t.j41(57,"th"),t.EFF(58,"Action"),t.k0s()()(),t.j41(59,"tbody"),t.DNE(60,D,21,15,"tr",12),t.k0s()()()()}if(2&i){const o=t.XpG();t.R7$(7),t.R50("ngModel",o.filtreJustif.id_promotion),t.R7$(3),t.Y8G("ngForOf",o.promotions),t.R7$(4),t.R50("ngModel",o.filtreJustif.id_etudiant),t.R7$(3),t.Y8G("ngForOf",o.etudiants),t.R7$(4),t.R50("ngModel",o.filtreJustif.statut),t.R7$(12),t.R50("ngModel",o.filtreJustif.date_min),t.R7$(4),t.R50("ngModel",o.filtreJustif.date_max),t.R7$(23),t.Y8G("ngForOf",o.justificatifs)}}let R=(()=>{class i{API=" https://emargementonline-production.up.railway.app/api";http=(0,t.WQX)(u.Qq);activePanel=null;promotions=[];promoEnEdition=!1;formPromo={id_promotion:null,nom:"",debut_annee_scolaire:"",fin_annee_scolaire:""};groupes=[];groupeEnEdition=!1;formGroupe={id_groupe:null,nom:"",id_promotion:""};etudiants=[];etudiantEnEdition=!1;formEtudiant={NEtudiant:"",nom:"",prenom:"",email:"",mot_de_passe:"",id_groupe_TD:"",id_groupe_Anglais:""};justificatifs=[];filtreJustif={id_promotion:"",id_etudiant:"",statut:"",date_min:"",date_max:""};headers=null;ngOnInit(){if(typeof window<"u"){const o=localStorage.getItem("_TOKEN_UTILISATEUR");if(o){const r=JSON.parse(o);this.headers=(new u.Lr).set("Authorization",`Bearer ${r.token}`),this.chargerPromotions(this.headers),this.chargerGroupes(this.headers),this.chargerEtudiants(this.headers),this.chargerJustificatifs(this.headers),this.activePanel="justificatifs"}}}togglePanel(o){this.activePanel=this.activePanel===o?null:o}chargerPromotions(o){this.http.get(`${this.API}/cfa/promotions`,{headers:o}).subscribe({next:r=>this.promotions=r,error:()=>console.error("\u274c Erreur chargement promotions")})}remplirForm(o){this.formPromo={...o},this.promoEnEdition=!0}soumettreForm(){const o=JSON.parse(localStorage.getItem("_TOKEN_UTILISATEUR")),r=(new u.Lr).set("Authorization",`Bearer ${o.token}`).set("Content-Type","application/json");this.http.request(this.formPromo.id_promotion?"PUT":"POST",this.formPromo.id_promotion?`${this.API}/cfa/promotions/${this.formPromo.id_promotion}`:`${this.API}/cfa/promotions`,{body:this.formPromo,headers:r}).subscribe({next:()=>{this.chargerPromotions(r),this.resetFormPromo()},error:()=>console.error("\u274c Erreur enregistrement promotion")})}supprimerPromotion(o){if(!confirm("Supprimer cette promotion ?"))return;const r=JSON.parse(localStorage.getItem("_TOKEN_UTILISATEUR")),e=(new u.Lr).set("Authorization",`Bearer ${r.token}`);this.http.delete(`${this.API}/cfa/promotions/${o}`,{headers:e}).subscribe({next:()=>this.chargerPromotions(e),error:()=>console.error("\u274c Erreur suppression promotion")})}resetFormPromo(){this.formPromo={id_promotion:null,nom:"",debut_annee_scolaire:"",fin_annee_scolaire:""},this.promoEnEdition=!1}chargerGroupes(o){this.http.get(`${this.API}/cfa/groupes`,{headers:o}).subscribe({next:r=>this.groupes=r,error:()=>console.error("\u274c Erreur chargement groupes")})}remplirFormGroupe(o){this.formGroupe={...o},this.groupeEnEdition=!0}soumettreFormGroupe(){const o=JSON.parse(localStorage.getItem("_TOKEN_UTILISATEUR")),r=(new u.Lr).set("Authorization",`Bearer ${o.token}`).set("Content-Type","application/json");this.http.request(this.formGroupe.id_groupe?"PUT":"POST",this.formGroupe.id_groupe?`${this.API}/cfa/groupes/${this.formGroupe.id_groupe}`:`${this.API}/cfa/groupes`,{body:{nom:this.formGroupe.nom,id_promotion:this.formGroupe.id_promotion},headers:r}).subscribe({next:()=>{this.chargerGroupes(r),this.resetFormGroupe()},error:()=>console.error("\u274c Erreur enregistrement groupe")})}supprimerGroupe(o){if(!confirm("Supprimer ce groupe ?"))return;const e=JSON.parse(localStorage.getItem("_TOKEN_UTILISATEUR")),n=(new u.Lr).set("Authorization",`Bearer ${e.token}`);this.http.delete(`${this.API}/cfa/groupes/${o}`,{headers:n}).subscribe({next:()=>this.chargerGroupes(n),error:()=>console.error("\u274c Erreur suppression groupe")})}resetFormGroupe(){this.formGroupe={id_groupe:null,nom:"",id_promotion:""},this.groupeEnEdition=!1}getNomPromotion(o){const r=this.promotions.find(e=>e.id_promotion===o);return r?r.nom:"?"}chargerEtudiants(o){this.http.get(`${this.API}/cfa/etudiants`,{headers:o}).subscribe({next:r=>this.etudiants=r,error:()=>console.error("\u274c Erreur chargement \xe9tudiants")})}remplirFormEtudiant(o){this.formEtudiant={...o,mot_de_passe:""},this.etudiantEnEdition=!0}soumettreFormEtudiant(){const o=JSON.parse(localStorage.getItem("_TOKEN_UTILISATEUR")),r=(new u.Lr).set("Authorization",`Bearer ${o.token}`).set("Content-Type","application/json"),e=!!this.formEtudiant.NEtudiant&&this.etudiantEnEdition,x={...this.formEtudiant};this.http.request(e?"PUT":"POST",e?`${this.API}/cfa/etudiants/${this.formEtudiant.NEtudiant}`:`${this.API}/cfa/etudiants`,{body:x,headers:r}).subscribe({next:()=>{this.chargerEtudiants(r),this.resetFormEtudiant()},error:()=>console.error("\u274c Erreur enregistrement \xe9tudiant")})}supprimerEtudiant(o){if(!confirm("Supprimer cet \xe9tudiant ?"))return;const e=JSON.parse(localStorage.getItem("_TOKEN_UTILISATEUR")),n=(new u.Lr).set("Authorization",`Bearer ${e.token}`);this.http.delete(`${this.API}/cfa/etudiants/${o}`,{headers:n}).subscribe({next:()=>this.chargerEtudiants(n),error:()=>console.error("\u274c Erreur suppression \xe9tudiant")})}resetFormEtudiant(){this.formEtudiant={NEtudiant:"",nom:"",prenom:"",email:"",mot_de_passe:"",id_groupe_TD:"",id_groupe_Anglais:""},this.etudiantEnEdition=!1}chargerJustificatifs(o){const r={};for(const[e,n]of Object.entries(this.filtreJustif))n&&(r[e]=n);this.http.get(`${this.API}/cfa/justificatifs`,{headers:o,params:r}).subscribe({next:e=>this.justificatifs=e,error:()=>console.error("\u274c Erreur chargement justificatifs")})}traiterJustificatif(o,r){const e=JSON.parse(localStorage.getItem("_TOKEN_UTILISATEUR")),n=(new u.Lr).set("Authorization",`Bearer ${e.token}`).set("Content-Type","application/json");this.http.patch(`${this.API}/cfa/justificatifs/${o.id}`,{statut:r,commentaire_admin:o.commentaire_admin},{headers:n}).subscribe({next:()=>this.chargerJustificatifs(n),error:()=>console.error(`\u274c Erreur traitement justificatif : ${o.id}`)})}chargerJustificatifsDepuisFiltres(){const o=JSON.parse(localStorage.getItem("_TOKEN_UTILISATEUR")),r=(new u.Lr).set("Authorization",`Bearer ${o.token}`),e={};for(const n in this.filtreJustif)this.filtreJustif[n]&&(e[n]=this.filtreJustif[n]);this.http.get(`${this.API}/cfa/justificatifs`,{headers:r,params:e}).subscribe({next:n=>this.justificatifs=n,error:()=>console.error("\u274c Erreur chargement justificatifs")})}static \u0275fac=function(r){return new(r||i)};static \u0275cmp=t.VBU({type:i,selectors:[["app-dashboard-cfa"]],decls:17,vars:4,consts:[["promoForm","ngForm"],["groupeForm","ngForm"],["etuForm","ngForm"],[1,"grayed-background","main-content"],[1,"container"],[1,"d-flex","flex-wrap","gap-3","justify-content-center","mb-4"],[1,"btn","btn-toggle",3,"click"],["class","accordion-panel card p-4 mb-4",4,"ngIf"],[1,"accordion-panel","card","p-4","mb-4"],[1,"mb-3"],[2,"max-height","400px","overflow-y","auto"],[1,"table","table-bordered"],[4,"ngFor","ngForOf"],[1,"mt-4",3,"ngSubmit"],["type","hidden","name","id",3,"ngModelChange","ngModel"],[1,"row","g-3"],[1,"col-md-4"],[1,"form-label"],["name","nom","required","",1,"form-control",3,"ngModelChange","ngModel"],["name","debut","required","",1,"form-control",3,"ngModelChange","ngModel"],["name","fin","required","",1,"form-control",3,"ngModelChange","ngModel"],["type","submit",1,"btn","btn-success","mt-3"],[1,"btn","btn-sm","btn-outline-primary","me-2",3,"click"],[1,"btn","btn-sm","btn-outline-danger",3,"click"],[1,"col-md-6"],["name","promotion","required","",1,"form-select",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["name","netu","required","",1,"form-control",3,"ngModelChange","ngModel","readonly"],["name","prenom","required","",1,"form-control",3,"ngModelChange","ngModel"],["name","email","required","",1,"form-control",3,"ngModelChange","ngModel"],["name","mdp",1,"form-control",3,"ngModelChange","ngModel"],["name","groupeTD","required","",1,"form-control",3,"ngModelChange","ngModel"],["name","groupeAnglais","required","",1,"form-control",3,"ngModelChange","ngModel"],[1,"row","g-3","mb-4",3,"ngSubmit"],[1,"col-md-3"],["name","filtrePromo",1,"form-select",3,"ngModelChange","ngModel"],["value",""],["name","filtreEtu",1,"form-select",3,"ngModelChange","ngModel"],[1,"col-md-2"],["name","filtreStatut",1,"form-select",3,"ngModelChange","ngModel"],["value","en_attente"],["value","accepte"],["value","refuse"],["type","date","name","filtreMin",1,"form-control",3,"ngModelChange","ngModel"],["type","date","name","filtreMax",1,"form-control",3,"ngModelChange","ngModel"],[1,"col-12","text-end"],["type","submit",1,"btn","btn-primary","mt-2"],["target","_blank",3,"href"],["placeholder","Commentaire...",1,"form-control",3,"ngModelChange","ngModel"],[3,"ngClass"],[1,"btn","btn-sm","btn-success","me-2",3,"click"],[1,"btn","btn-sm","btn-danger",3,"click"]],template:function(r,e){1&r&&(t.nrm(0,"app-header"),t.j41(1,"main",3)(2,"div",4)(3,"div",5)(4,"button",6),t.bIt("click",function(){return e.togglePanel("promotions")}),t.EFF(5," \u{1f393} G\xe9rer les Promotions "),t.k0s(),t.j41(6,"button",6),t.bIt("click",function(){return e.togglePanel("groupes")}),t.EFF(7," \u{1f465} G\xe9rer les Groupes de TD "),t.k0s(),t.j41(8,"button",6),t.bIt("click",function(){return e.togglePanel("etudiants")}),t.EFF(9," \u{1f9d1}\u200d\u{1f3eb} G\xe9rer les \xc9tudiants "),t.k0s(),t.j41(10,"button",6),t.bIt("click",function(){return e.togglePanel("justificatifs")}),t.EFF(11," \u{1f4ce} G\xe9rer les Justificatifs "),t.k0s()(),t.DNE(12,g,39,6,"div",7)(13,F,34,6,"div",7)(14,j,58,10,"div",7)(15,M,61,8,"div",7),t.k0s()(),t.nrm(16,"app-footer")),2&r&&(t.R7$(12),t.Y8G("ngIf","promotions"===e.activePanel),t.R7$(),t.Y8G("ngIf","groupes"===e.activePanel),t.R7$(),t.Y8G("ngIf","etudiants"===e.activePanel),t.R7$(),t.Y8G("ngIf","justificatifs"===e.activePanel))},dependencies:[c.l,l.n,m.MD,m.YU,m.Sq,m.bT,m.vh,s.YN,s.qT,s.xH,s.y7,s.me,s.wz,s.BC,s.cb,s.YS,s.vS,s.cV],styles:[".btn-toggle[_ngcontent-%COMP%]{background-color:#036;color:#fff;padding:10px 18px;border-radius:12px;border:none;font-weight:700;transition:all .2s ease}.btn-toggle[_ngcontent-%COMP%]:hover{background-color:#0055a5}.accordion-panel[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .3s ease-in-out;border-radius:16px;background:#fff;box-shadow:0 4px 10px #00000008;padding:2rem}.accordion-panel[_ngcontent-%COMP%] + .accordion-panel[_ngcontent-%COMP%]{margin-top:2rem}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.table[_ngcontent-%COMP%]{background-color:#fff;border-radius:12px;overflow:hidden;box-shadow:0 4px 12px #0000000d}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f0f0f0;font-weight:700;text-align:left}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:12px 16px;vertical-align:middle}form[_ngcontent-%COMP%]{background-color:#fafafa;border-radius:12px;padding:1.5rem;box-shadow:0 4px 12px #0000000a;margin-top:2rem}form[_ngcontent-%COMP%]   .form-label[_ngcontent-%COMP%]{font-weight:600}input.form-control[_ngcontent-%COMP%], select.form-select[_ngcontent-%COMP%]{border-radius:10px;padding:8px 12px;font-size:.95rem}button[type=submit][_ngcontent-%COMP%]{font-weight:600;padding:10px 20px;border-radius:10px;transition:background-color .2s ease}button[type=submit][_ngcontent-%COMP%]:hover{background-color:#28a745!important;color:#fff}@media (max-width: 768px){.accordion-panel[_ngcontent-%COMP%]{padding:1rem}.btn-toggle[_ngcontent-%COMP%]{width:100%;text-align:center}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:10px}}.text-warning[_ngcontent-%COMP%]{color:#ffc107;font-weight:700}.text-success[_ngcontent-%COMP%]{color:#28a745;font-weight:700}.text-danger[_ngcontent-%COMP%]{color:#dc3545;font-weight:700}"]})}return i})()}}]);